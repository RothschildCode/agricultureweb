webpackJsonp([5],{138:function(module,exports){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{attrs:{id:"app"}},[_c("f7-views",[_c("f7-view",{attrs:{id:"main-view",main:""}},[_c("f7-pages",[_c("div",{staticClass:"page reply-page"},[_c("canvas",{ref:"cvs",staticStyle:{display:"none"}}),_vm._v(" "),_c("div",{staticClass:"page-content"},[_c("a",{staticClass:"floating-button",attrs:{href:"#"},on:{click:function($event){_vm.publish()}}},[_vm._v("发布")]),_vm._v(" "),_c("div",{staticClass:"content-block-title"},[_vm._v("帖子标题")]),_vm._v(" "),_c("div",{staticClass:"list-block"},[_c("ul",[_c("li",[_c("div",{staticClass:"item-content"},[_c("div",{staticClass:"item-inner"},[_c("div",{staticClass:"item-input"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.subject,expression:"subject"}],attrs:{type:"text",name:"",placeholder:"给帖子起一个标题吧"},domProps:{value:_vm.subject},on:{input:function($event){$event.target.composing||(_vm.subject=$event.target.value)}}})])])])])])]),_vm._v(" "),_c("div",{staticClass:"content-block-title"},[_vm._v("帖子内容")]),_vm._v(" "),_c("div",{staticClass:"list-block"},[_c("ul",[_c("li",[_c("div",{staticClass:"item-content"},[_c("div",{staticClass:"item-inner"},[_c("div",{staticClass:"item-input"},[_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.comment,expression:"comment"}],attrs:{placeholder:"我来说两句"},domProps:{value:_vm.comment},on:{input:function($event){$event.target.composing||(_vm.comment=$event.target.value)}}})])])]),_vm._v(" "),_c("multi-preview",{attrs:{data:_vm.enclosures,inputDom:_vm.inputDom}}),_vm._v(" "),_c("a",{staticClass:"chip topic-chip open-popup",attrs:{"data-popup":".popup-topic"}},[_c("div",{staticClass:"chip-label"},[_vm._v("#"+_vm._s(_vm.selTopic.cname||"未选择话题")+"#")])])],1)])])])])])],1)],1),_vm._v(" "),_c("div",{staticClass:"popup popup-topic"},[_c("div",{staticClass:"navbar"},[_c("div",{staticClass:"navbar-inner h-auto"},[_c("div",{staticClass:"subnavbar tabs-row"},[_c("div",{staticClass:"buttons-row"},[_c("a",{staticClass:"button tab-link",on:{click:_vm.closePopup}},[_vm._v("\n    \t\t\t\t\t\t关闭\n    \t\t\t\t\t")])])])])]),_vm._v(" "),_c("div",{staticClass:"page navbar-through"},[_c("div",{staticClass:"page-content"},[_c("div",{staticClass:"list-block"},[_c("ul",_vm._l(_vm.topics,function(item){return _c("li",{staticClass:"item-content",on:{click:function($event){_vm.topicItemClick(item)}}},[_vm._m(0,!0),_vm._v(" "),_c("div",{staticClass:"item-inner"},[_c("div",{staticClass:"item-title",domProps:{innerHTML:_vm._s(item.cname)}})])])}))])])])])],1)},staticRenderFns:[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"item-media"},[_c("i",[_vm._v("#")])])}]}},208:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__component_BrowPanel__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_0__component_BrowPanel___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__component_BrowPanel__),__WEBPACK_IMPORTED_MODULE_1__plugins_imguploader__=__webpack_require__(31),__WEBPACK_IMPORTED_MODULE_2__component_MultiPreview__=__webpack_require__(45),__WEBPACK_IMPORTED_MODULE_2__component_MultiPreview___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__component_MultiPreview__),__WEBPACK_IMPORTED_MODULE_3__core_vbus__=__webpack_require__(1);__webpack_exports__.default={data:function(){return{subject:"",comment:"",showCode:0,multis:[],enclosures:[],initUploader:!1,type:1,pageId:0,topics:[],selTopic:{},pid:null,cid:null,inputDom:null,brow:null}},watch:{brow:function(newVal,oldVal){this.comment+=newVal}},created:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_3__core_vbus__.a.$on(__WEBPACK_IMPORTED_MODULE_3__core_vbus__.b.SEL_BROW,function(d){_this.comment+=d});var params=this.appUtil.getCache("editor_page_params");this.replyType=params.replyType,this.pid=params.pId,this.cid=params.cId,this.type=params.type,this.pageId=params.pageId,1==this.type&&this.getTopics()},methods:{getTopics:function(){var self=this;this.$ajax({data:{api:"page_type",pageid:this.pageId}},function(data){self.topics=data})},uploadChange:function(e){return void(this.inputDom=e)},changePanel:function(code){1!=code&&3!=code||(code=this.showCode==code?0:code),this.showCode=code},publish:function(){var _this2=this;if(""==this.subject)return void this.$f7.modal({title:"写一个标题吧:(",buttons:[{text:"嗯，好的"}]});if(""==this.comment)return void this.$f7.modal({title:"没有发表任何内容哦，写点东西吧:(",buttons:[{text:"嗯，好的"}]});if(!this.selTopic.cid)return void this.$f7.modal({title:"选择一个话题吧:(",buttons:[{text:"嗯，好的"}]});var self=this,uploader=new __WEBPACK_IMPORTED_MODULE_1__plugins_imguploader__.a;this.appUtil.loginedInfo(function(_ref){var uid=_ref.uid,area=_ref.area;uploader.upload(_this2.enclosures,function(urlsText){self.$ajax({data:{api:"publish_post",cid:self.selTopic.cid,fid:2,subject:self.subject,message:self.comment,pageid:self.pageId,img:urlsText,uid:uid,area:area},errorMsg:"发布失败了:("},function(data){self.$f7.modal({title:"发布成功:)",buttons:[{text:"好",onClick:function(){self.appUtil.applyNativeMethod("goFinash")}}]})})})})},reply:function(){if(""==this.comment)return void this.$f7.modal({title:"内容不能为空，写点东西吧:(",buttons:[{text:"这就去写"}]});var self=this;(new __WEBPACK_IMPORTED_MODULE_1__plugins_imguploader__.a).upload(this.enclosures,function(urlsText){var api=self.cid?"insert_reply":"insert_comment",param={api:api,pid:self.pid,uid:"1"};self.cid?(param.cid=self.cid,param.content=self.comment):param.comment=self.comment,self.$ajax({data:param,errorMsg:"糟糕，回复失败了:("},function(data){self.$f7.modal({title:"回复成功:)",buttons:[{text:"好"}]})})})},selectedMulti:function(base64Data){this.multis.push('url("'+base64Data+'")')},removeMulti:function(i){this.multis.splice(i,1),this.enclosures.splice(i,1)},topicItemClick:function(data){this.selTopic=data,this.closePopup()},closePopup:function(){this.$f7.closeModal(".popup-topic")}},components:{BrowPanel:__WEBPACK_IMPORTED_MODULE_0__component_BrowPanel___default.a,MultiPreview:__WEBPACK_IMPORTED_MODULE_2__component_MultiPreview___default.a}}},21:function(module,exports,__webpack_require__){__webpack_require__(24);var $Object=__webpack_require__(8).Object;module.exports=function(it,key,desc){return $Object.defineProperty(it,key,desc)}},216:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__main_js__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_1__pages_Reply__=__webpack_require__(93),__WEBPACK_IMPORTED_MODULE_1__pages_Reply___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__pages_Reply__),__WEBPACK_IMPORTED_MODULE_2__plugins_brow_iconfont_js__=__webpack_require__(72);__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__plugins_brow_iconfont_js__);__WEBPACK_IMPORTED_MODULE_0__main_js__.a(__WEBPACK_IMPORTED_MODULE_1__pages_Reply___default.a)},24:function(module,exports,__webpack_require__){var $export=__webpack_require__(22);$export($export.S+$export.F*!__webpack_require__(4),"Object",{defineProperty:__webpack_require__(5).f})},25:function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(21),__esModule:!0}},26:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0,exports.default=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},27:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperty=__webpack_require__(25),_defineProperty2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_defineProperty);exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}()},31:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_2__core_http__=__webpack_require__(39),EnclosureUploader=function(){function EnclosureUploader(){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default()(this,EnclosureUploader),this.resultSet=new Array,this.poster=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__core_http__.b)()}return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default()(EnclosureUploader,[{key:"upload",value:function(files,callback){if(files.length<=0)callback();else{var _this=this;if((files=this.filter(files))&&files.length>0)for(var i=0;i<files.length;i++)_this.poster({data:{filetype:"image",name:"111.jpg",data:files[i]},method:"post"}).then(function(res){_this.resultSet.push(res.data),_this.resultSet.length==files.length&&callback(_this.urlsText())});else callback(null)}}},{key:"urlsText",value:function(){for(var url="",i=0;i<this.resultSet.length;i++)0!=i&&(url+=";"),url+=this.resultSet[i];return url}},{key:"filter",value:function(files){for(var newFiles=new Array,i=0;i<files.length;i++)files[i]&&""!=files[i]&&newFiles.push(files[i]);return newFiles}}]),EnclosureUploader}();__webpack_exports__.a=EnclosureUploader},44:function(module,exports,__webpack_require__){var Component=__webpack_require__(0)(__webpack_require__(65),__webpack_require__(50),null,null);module.exports=Component.exports},45:function(module,exports,__webpack_require__){var Component=__webpack_require__(0)(__webpack_require__(66),__webpack_require__(49),null,null);module.exports=Component.exports},49:function(module,exports){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"multi-preview"},[_c("canvas",{ref:"cvs",staticStyle:{display:"none"}}),_vm._v(" "),_c("div",{staticClass:"multi-content",style:{width:95*(_vm.multis.length+1)+10+"px"}},[_vm._l(_vm.urls,function(item,$index){return _vm.readonly?_c("div",{staticClass:"item"},[_c("span",{staticClass:"item-span",style:{backgroundImage:"url("+item+")"},on:{click:function($event){_vm.preview($index)}}})]):_vm._e()}),_vm._v(" "),_vm._l(_vm.multis,function(item,index){return _vm.readonly?_vm._e():_c("div",{staticClass:"item"},[_c("span",{staticClass:"item-span",style:{"background-image":item}}),_vm._v(" "),_c("a",{staticClass:"item-close",on:{click:function($event){_vm.removeMulti(index)}}},[_c("span",{staticClass:"btn-close"})])])}),_vm._v(" "),_vm.readonly?_vm._e():_c("div",{staticClass:"item add"},[_c("input",{ref:"uploadInput2",staticClass:"upload-input",attrs:{type:"file",name:""},on:{change:_vm.uploadChange}})])],2)])},staticRenderFns:[]}},50:function(module,exports){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"panel",staticClass:"brow-panel-wrapper"},_vm._l(_vm.group,function(g){return _c("div",{staticClass:"row"},_vm._l(g,function(item){return _c("div",{staticClass:"col-20 brow-item-wrapper",on:{click:function($event){_vm.sel(item)}}},[_c("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[_c("use",{attrs:{"xlink:href":item.link}})])])}))}))},staticRenderFns:[]}},65:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__core_vbus__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_1__common_browsMap__=__webpack_require__(69);__webpack_exports__.default={props:["defaultClose"],data:function(){return{group:[],panel:null}},created:function(){for(var group=new Array,i=0;i<__WEBPACK_IMPORTED_MODULE_1__common_browsMap__.a.length;i++){var inx=Math.floor(i/5);group[inx]||(group[inx]=new Array),group[inx].push(__WEBPACK_IMPORTED_MODULE_1__common_browsMap__.a[i])}this.group=group},mounted:function(){this.panel=this.$$(this.$refs.panel),1==this.defaultClose&&this.close()},methods:{sel:function(b){__WEBPACK_IMPORTED_MODULE_0__core_vbus__.a.$emit(__WEBPACK_IMPORTED_MODULE_0__core_vbus__.b.SEL_BROW,"（#"+b.name+"）")},open:function(){this.panel.css("height","11rem")},close:function(){this.panel.css("height","0")}}}},66:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_exports__.default={props:["data","urls","readonly","inputDom"],data:function(){return{maxSize:960,multis:[]}},created:function(){this.readonly&&(this.multis=this.urls||[])},watch:{inputDom:function(newVal,oldVal){this.uploadChange(newVal)}},methods:{uploadChange:function(e){var file,_this=this,loader=e.target;(file=loader.files[0])&&_this.compress(file),$(loader).val("")},compress:function(file){var _this=this,image=new Image,scale=1;image.src=URL.createObjectURL(file),image.onload=function(){var cvs=_this.$refs.cvs;(this.width>_this.maxSize||this.height>_this.maxSize)&&(scale=this.width>this.height?_this.maxSize/this.width:_this.maxSize/this.height),cvs.width=this.width*scale,cvs.height=this.height*scale,cvs.getContext("2d").drawImage(this,0,0,cvs.width,cvs.height);var newImageData=cvs.toDataURL("image/jpeg",.7);_this.selectedMulti(newImageData.replace("data:base64","data:image/jpeg;base64")),_this.data.push(newImageData.replace("data:image/jpeg;base64,",""))}},selectedMulti:function(base64Data){this.multis.push('url("'+base64Data+'")')},removeMulti:function(i){this.multis.splice(i,1),this.data.splice(i,1)},preview:function(index){this.$f7.photoBrowser({photos:this.urls,initialSlide:index,theme:"dark",backLinkText:"关闭"}).open()}}}},93:function(module,exports,__webpack_require__){var Component=__webpack_require__(0)(__webpack_require__(208),__webpack_require__(138),null,null);module.exports=Component.exports}},[216]);